# 9. Acceptance Criteria for MVP

## 9.1 End-to-End Flows

### Critical User Journeys

**MVP 출시 전 반드시 작동해야 하는 시나리오**:

1. **회원가입 → 로그인 → 첫 카드 완료** (50/60/70대 공통):
   - 이메일/비밀번호 회원가입 → 프로필 생성 확인
   - 로그인 → 홈 화면 표시
   - 오늘의 카드 조회 → 상세 화면
   - TTS 재생 (선택적)
   - 퀴즈 풀기 → 정답 확인
   - "완료" 버튼 → 포인트 10+5점 획득 → 애니메이션

2. **인사이트 조회 → 반응** (50/60대):
   - 인사이트 허브 진입 → 토픽 선택 (ai)
   - 최신 10개 리스트 표시
   - 인사이트 클릭 → 상세 본문 + TTS
   - "도움됐어요" 버튼 → 카운트 증가 + 포인트 2점

3. **음성 인텐트: 전화 걸기** (60/70대):
   - 홈 → 음성 버튼 탭
   - "엄마에게 전화해 줘" 말하기
   - BFF 파싱 → 확인 다이얼로그 표시
   - 승인 → 전화 앱 실행

4. **사기검사: 스미싱 감지** (60대):
   - 홈 → 사기검사 진입
   - 의심 문자 붙여넣기
   - 검사 실행 → danger 판정 + 설명 + 행동 팁
   - 포인트 3점

5. **도구 트랙 완주** (50대):
   - 도구 트랙 목록 → 미리캔버스 선택
   - 1단계 시작 → 체크리스트 + 퀴즈 완료 → 단계 완료
   - 2-4단계 반복
   - 트랙 완주 → 배지 "도구 마스터" 획득 + 포인트 20점

6. **Q&A 작성 → 투표** (50/60대):
   - 커뮤니티 → 폰 주제 → "질문하기"
   - 제목 + 본문 작성 → 제출
   - 다른 사용자가 조회 → "도움됐어요" 투표
   - 작성자 포인트 1점

7. **복약 체크 → 스트릭** (60/70대):
   - 홈 → "오늘 약 먹기" 버튼
   - 체크 완료 → 포인트 3점
   - 3일 연속 → "3일 연속!" 메시지 + 스트릭 표시

8. **가족 대시보드 조회** (가족):
   - 웹 로그인 (guardian 계정)
   - 대시보드 → 시니어 목록 카드
   - 시니어 클릭 → 상세 페이지 (주간 카드 5/7, 복약 히스토리)

9. **접근성 모드 변경** (70대):
   - 프로필 → 접근성 설정
   - 초간단 모드(ultra) 선택
   - 홈 화면 → 버튼 3개만 + 폰트 28sp + 터치 80x80dp

10. **배지 획득** (50/60/70대 공통):
    - 첫 카드 완료 → "첫걸음" 배지
    - 7일 연속 카드 → "꾸준한 학습자" 배지
    - 프로필에서 배지 목록 확인

### Success Metrics

**각 시나리오에 대한 성공 기준**:

- **완료율**: 테스트 사용자 10명 중 최소 8명이 시나리오 완료
- **오류 없음**: 치명적 에러 (앱 크래시, 데이터 손실) 0건
- **사용자 피드백**: "이해하기 쉬웠다" 평균 4점 이상 (5점 척도)
- **소요 시간**:
  - 회원가입 → 첫 카드 완료: 5분 이내 (70대 10분)
  - 사기검사: 1분 이내
  - 복약 체크: 10초 이내

## 9.2 Accessibility Requirements

### WCAG Compliance Level

**목표**: WCAG 2.1 AA 준수 (최소)

**필수 체크리스트**:

1. **색상 대비**:
   - 일반 텍스트: 최소 4.5:1
   - 큰 텍스트 (18sp 이상): 최소 3:1
   - 경고/위험 색상은 색상만으로 구분 금지 (아이콘 병행)

2. **키보드 접근성** (웹만 해당):
   - 모든 기능 키보드로 접근 가능
   - Tab 순서 논리적
   - Focus 표시 명확

3. **스크린 리더 지원**:
   - 모든 버튼/링크에 명확한 라벨
   - 이미지에 대체 텍스트 (decorative 이미지는 제외)
   - 상태 변화 알림 (예: "포인트가 10점 증가했습니다")

4. **시간 제한 없음**:
   - 세션 타임아웃 최소 30분
   - 타임아웃 전 경고 + 연장 옵션

### TTS Coverage

**TTS 필수 제공 텍스트**:
- 카드: TL;DR, body, impact, 퀴즈 문제/해설
- 인사이트: 본문 전체
- 에러 메시지: 중요 에러 (네트워크 오류, 권한 필요)
- 사기검사 결과: 판정 + 설명 + 행동 팁

**TTS 제외**:
- 버튼 라벨 (스크린 리더가 읽음)
- 짧은 토스트 메시지 (3초 내 사라짐)

**TTS 품질**:
- 한국어 음성 (OS 기본 TTS 엔진 사용)
- 재생 속도 조절 가능 (0.8x, 1.0x, 1.2x)
- 일시정지/재개 버튼

### Touch Target Sizes

**모드별 최소 크기**:
- **Normal**: 44x44dp (iOS HIG 권장)
- **Easy**: 60x60dp
- **Ultra**: 80x80dp

**간격**:
- 버튼 간 최소 8dp (normal), 16dp (easy), 24dp (ultra)

**예외**:
- 긴 텍스트 링크는 높이만 44dp 이상 (너비는 텍스트 길이)

## 9.3 Performance Targets

### Client-Side Latency

**모바일 앱 (Expo)**:

- **초기 로딩** (스플래시 → 홈):
  - Normal: < 2초
  - 3G 네트워크: < 5초

- **화면 전환**:
  - 네비게이션 애니메이션: 60fps (16ms/frame)
  - 데이터 로딩 포함: < 1초

- **카드 조회**:
  - Supabase 직접 조회: P95 < 500ms
  - 캐시 히트: < 100ms

- **TTS 재생 시작**:
  - 버튼 클릭 → 첫 소리: < 300ms

- **음성 인식**:
  - STT 완료 → 인텐트 파싱: < 1초

### Server-Side P95

**BFF (FastAPI)**:

- **읽기 API**:
  - `GET /cards/today`: < 200ms
  - `GET /insights?topic=ai`: < 300ms

- **쓰기 API (단순)**:
  - `POST /cards/{id}/complete`: < 500ms (gamification 포함)
  - `POST /med/check`: < 400ms

- **쓰기 API (복잡)**:
  - `POST /voice/parse`: < 1000ms (연락처 조회 포함)
  - `POST /scam/check`: < 800ms (룰 엔진 실행)

- **Supabase 직접 조회**:
  - 간단 SELECT: P95 < 100ms
  - JOIN 쿼리: P95 < 300ms

### Cache Hit Rates

**Redis 캐싱 목표**:

- **사용자 프로필**: 80% 이상
- **오늘의 카드**: 70% 이상 (아침 피크 시간)
- **인사이트 목록**: 60% 이상

**측정 방법**:
- Redis 명령어 카운트: `INFO stats` (keyspace_hits / keyspace_misses)
- BFF 로그: 캐시 히트 여부 기록

## 9.4 Analytics & Metrics

### Required Events

**MVP 출시 시 추적해야 하는 최소 이벤트**:

1. **사용자 온보딩**:
   - `user_signup` (age_band, a11y_mode)
   - `user_login`

2. **카드 관련**:
   - `card_viewed` (card_id, type)
   - `card_completed` (card_id, quiz_score)
   - `card_tts_played` (card_id)

3. **인사이트**:
   - `insight_viewed` (insight_id, topic)
   - `insight_reacted` (insight_id, reaction_type)

4. **음성 인텐트**:
   - `voice_intent_parsed` (intent, confidence)
   - `voice_intent_executed` (intent, success)

5. **사기검사**:
   - `scam_check_performed` (label, confidence)

6. **도구 트랙**:
   - `tool_step_completed` (track_id, step_num)

7. **커뮤니티**:
   - `qna_post_created` (subject, is_anon)
   - `qna_post_voted` (post_id)

8. **복약**:
   - `med_check_completed` (time_slot, streak)

9. **게임화**:
   - `points_awarded` (amount, reason)
   - `badge_earned` (badge_id)
   - `streak_updated` (current_streak)

10. **접근성**:
    - `a11y_mode_changed` (from, to)

### Dashboard Views

**관리자/운영팀용 대시보드 필수 뷰**:

1. **일일 활성 사용자 (DAU)**:
   - 연령대별 (50/60/70)
   - 접근성 모드별 (normal/easy/ultra)

2. **기능별 사용률**:
   - 카드 완료율 (전체 사용자 중 오늘 카드 완료한 비율)
   - 음성 인텐트 사용자 수
   - 사기검사 사용자 수
   - Q&A 작성자 수

3. **성능 메트릭**:
   - BFF API P95 레이턴시 (엔드포인트별)
   - 에러율 (4xx, 5xx)
   - 캐시 히트율

4. **게임화 현황**:
   - 평균 포인트 (연령대별)
   - 평균 스트릭
   - 배지 획득 분포

5. **가족 대시보드 사용**:
   - 활성 가족 링크 수
   - 가족 대시보드 조회 수

### Alert Thresholds

**즉시 알림이 필요한 상황**:

1. **에러율 급증**:
   - 5분간 5xx 에러 > 5% → Slack 알림
   - 특정 엔드포인트 에러율 > 10% → 즉시 조사

2. **성능 저하**:
   - P95 레이턴시 > 목표의 2배 (예: 카드 조회 > 1000ms)
   - Redis 응답 시간 > 50ms

3. **보안 이슈**:
   - 동일 IP에서 1분간 로그인 실패 > 10회 → 차단 고려
   - RLS 정책 위반 시도 감지 (audit_logs)

4. **비즈니스 이상**:
   - 일일 카드 완료율 < 30% (평소 50%) → 원인 조사
   - 사기검사 danger 판정 비율 > 80% (평소 20%) → 룰 오류 의심

5. **인프라**:
   - Supabase/Redis 연결 실패 → 즉시 알림
   - 디스크/메모리 사용률 > 80%

---

## 최종 요약

- **섹션 7**: 6주 마일스톤 계획 (주차별 목표, 산출물, 데모, 우선순위)
- **섹션 8**: 10가지 리스크 (UI 복잡도, RLS, LLM 비용, Redis, 커뮤니티, TTS, 가족, 마이그레이션, API 의존, 접근성) 및 완화 방안
- **섹션 9**: MVP 수락 기준 (E2E 시나리오 10개, 접근성 요구사항, 성능 목표, 분석 이벤트, 알림 임계값)

**이 계획 문서(`docs/PLAN.md`)는 이제 완성되었습니다.** 모든 엔지니어, 디자이너, PM이 참조하여 MVP 구현을 진행할 수 있습니다.
